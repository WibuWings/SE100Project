{"ast":null,"code":"'use strict';\n\nvar util = require('util');\n\nvar TrackerBase = require('./tracker-base.js');\n\nvar Tracker = require('./tracker.js');\n\nvar TrackerStream = require('./tracker-stream.js');\n\nvar TrackerGroup = module.exports = function (name) {\n  TrackerBase.call(this, name);\n  this.parentGroup = null;\n  this.trackers = [];\n  this.completion = {};\n  this.weight = {};\n  this.totalWeight = 0;\n  this.finished = false;\n  this.bubbleChange = bubbleChange(this);\n};\n\nutil.inherits(TrackerGroup, TrackerBase);\n\nfunction bubbleChange(trackerGroup) {\n  return function (name, completed, tracker) {\n    trackerGroup.completion[tracker.id] = completed;\n    if (trackerGroup.finished) return;\n    trackerGroup.emit('change', name || trackerGroup.name, trackerGroup.completed(), trackerGroup);\n  };\n}\n\nTrackerGroup.prototype.nameInTree = function () {\n  var names = [];\n  var from = this;\n\n  while (from) {\n    names.unshift(from.name);\n    from = from.parentGroup;\n  }\n\n  return names.join('/');\n};\n\nTrackerGroup.prototype.addUnit = function (unit, weight) {\n  if (unit.addUnit) {\n    var toTest = this;\n\n    while (toTest) {\n      if (unit === toTest) {\n        throw new Error('Attempted to add tracker group ' + unit.name + ' to tree that already includes it ' + this.nameInTree(this));\n      }\n\n      toTest = toTest.parentGroup;\n    }\n\n    unit.parentGroup = this;\n  }\n\n  this.weight[unit.id] = weight || 1;\n  this.totalWeight += this.weight[unit.id];\n  this.trackers.push(unit);\n  this.completion[unit.id] = unit.completed();\n  unit.on('change', this.bubbleChange);\n  if (!this.finished) this.emit('change', unit.name, this.completion[unit.id], unit);\n  return unit;\n};\n\nTrackerGroup.prototype.completed = function () {\n  if (this.trackers.length === 0) return 0;\n  var valPerWeight = 1 / this.totalWeight;\n  var completed = 0;\n\n  for (var ii = 0; ii < this.trackers.length; ii++) {\n    var trackerId = this.trackers[ii].id;\n    completed += valPerWeight * this.weight[trackerId] * this.completion[trackerId];\n  }\n\n  return completed;\n};\n\nTrackerGroup.prototype.newGroup = function (name, weight) {\n  return this.addUnit(new TrackerGroup(name), weight);\n};\n\nTrackerGroup.prototype.newItem = function (name, todo, weight) {\n  return this.addUnit(new Tracker(name, todo), weight);\n};\n\nTrackerGroup.prototype.newStream = function (name, todo, weight) {\n  return this.addUnit(new TrackerStream(name, todo), weight);\n};\n\nTrackerGroup.prototype.finish = function () {\n  this.finished = true;\n  if (!this.trackers.length) this.addUnit(new Tracker(), 1, true);\n\n  for (var ii = 0; ii < this.trackers.length; ii++) {\n    var tracker = this.trackers[ii];\n    tracker.finish();\n    tracker.removeListener('change', this.bubbleChange);\n  }\n\n  this.emit('change', this.name, 1, this);\n};\n\nvar buffer = '                                  ';\n\nTrackerGroup.prototype.debug = function (depth) {\n  depth = depth || 0;\n  var indent = depth ? buffer.substr(0, depth) : '';\n  var output = indent + (this.name || 'top') + ': ' + this.completed() + '\\n';\n  this.trackers.forEach(function (tracker) {\n    if (tracker instanceof TrackerGroup) {\n      output += tracker.debug(depth + 1);\n    } else {\n      output += indent + ' ' + tracker.name + ': ' + tracker.completed() + '\\n';\n    }\n  });\n  return output;\n};","map":{"version":3,"sources":["D:/UIT/Nam3_HKI/OOP/SE100Project/client/node_modules/are-we-there-yet/tracker-group.js"],"names":["util","require","TrackerBase","Tracker","TrackerStream","TrackerGroup","module","exports","name","call","parentGroup","trackers","completion","weight","totalWeight","finished","bubbleChange","inherits","trackerGroup","completed","tracker","id","emit","prototype","nameInTree","names","from","unshift","join","addUnit","unit","toTest","Error","push","on","length","valPerWeight","ii","trackerId","newGroup","newItem","todo","newStream","finish","removeListener","buffer","debug","depth","indent","substr","output","forEach"],"mappings":"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","sourcesContent":["'use strict'\nvar util = require('util')\nvar TrackerBase = require('./tracker-base.js')\nvar Tracker = require('./tracker.js')\nvar TrackerStream = require('./tracker-stream.js')\n\nvar TrackerGroup = module.exports = function (name) {\n  TrackerBase.call(this, name)\n  this.parentGroup = null\n  this.trackers = []\n  this.completion = {}\n  this.weight = {}\n  this.totalWeight = 0\n  this.finished = false\n  this.bubbleChange = bubbleChange(this)\n}\nutil.inherits(TrackerGroup, TrackerBase)\n\nfunction bubbleChange (trackerGroup) {\n  return function (name, completed, tracker) {\n    trackerGroup.completion[tracker.id] = completed\n    if (trackerGroup.finished) return\n    trackerGroup.emit('change', name || trackerGroup.name, trackerGroup.completed(), trackerGroup)\n  }\n}\n\nTrackerGroup.prototype.nameInTree = function () {\n  var names = []\n  var from = this\n  while (from) {\n    names.unshift(from.name)\n    from = from.parentGroup\n  }\n  return names.join('/')\n}\n\nTrackerGroup.prototype.addUnit = function (unit, weight) {\n  if (unit.addUnit) {\n    var toTest = this\n    while (toTest) {\n      if (unit === toTest) {\n        throw new Error(\n          'Attempted to add tracker group ' +\n          unit.name + ' to tree that already includes it ' +\n          this.nameInTree(this))\n      }\n      toTest = toTest.parentGroup\n    }\n    unit.parentGroup = this\n  }\n  this.weight[unit.id] = weight || 1\n  this.totalWeight += this.weight[unit.id]\n  this.trackers.push(unit)\n  this.completion[unit.id] = unit.completed()\n  unit.on('change', this.bubbleChange)\n  if (!this.finished) this.emit('change', unit.name, this.completion[unit.id], unit)\n  return unit\n}\n\nTrackerGroup.prototype.completed = function () {\n  if (this.trackers.length === 0) return 0\n  var valPerWeight = 1 / this.totalWeight\n  var completed = 0\n  for (var ii = 0; ii < this.trackers.length; ii++) {\n    var trackerId = this.trackers[ii].id\n    completed += valPerWeight * this.weight[trackerId] * this.completion[trackerId]\n  }\n  return completed\n}\n\nTrackerGroup.prototype.newGroup = function (name, weight) {\n  return this.addUnit(new TrackerGroup(name), weight)\n}\n\nTrackerGroup.prototype.newItem = function (name, todo, weight) {\n  return this.addUnit(new Tracker(name, todo), weight)\n}\n\nTrackerGroup.prototype.newStream = function (name, todo, weight) {\n  return this.addUnit(new TrackerStream(name, todo), weight)\n}\n\nTrackerGroup.prototype.finish = function () {\n  this.finished = true\n  if (!this.trackers.length) this.addUnit(new Tracker(), 1, true)\n  for (var ii = 0; ii < this.trackers.length; ii++) {\n    var tracker = this.trackers[ii]\n    tracker.finish()\n    tracker.removeListener('change', this.bubbleChange)\n  }\n  this.emit('change', this.name, 1, this)\n}\n\nvar buffer = '                                  '\nTrackerGroup.prototype.debug = function (depth) {\n  depth = depth || 0\n  var indent = depth ? buffer.substr(0, depth) : ''\n  var output = indent + (this.name || 'top') + ': ' + this.completed() + '\\n'\n  this.trackers.forEach(function (tracker) {\n    if (tracker instanceof TrackerGroup) {\n      output += tracker.debug(depth + 1)\n    } else {\n      output += indent + ' ' + tracker.name + ': ' + tracker.completed() + '\\n'\n    }\n  })\n  return output\n}\n"]},"metadata":{},"sourceType":"script"}