{"ast":null,"code":"'use strict';\n\nvar Plumbing = require('./plumbing.js');\n\nvar hasUnicode = require('has-unicode');\n\nvar hasColor = require('./has-color.js');\n\nvar onExit = require('signal-exit');\n\nvar defaultThemes = require('./themes');\n\nvar setInterval = require('./set-interval.js');\n\nvar process = require('./process.js');\n\nvar setImmediate = require('./set-immediate');\n\nmodule.exports = Gauge;\n\nfunction callWith(obj, method) {\n  return function () {\n    return method.call(obj);\n  };\n}\n\nfunction Gauge(arg1, arg2) {\n  var options, writeTo;\n\n  if (arg1 && arg1.write) {\n    writeTo = arg1;\n    options = arg2 || {};\n  } else if (arg2 && arg2.write) {\n    writeTo = arg2;\n    options = arg1 || {};\n  } else {\n    writeTo = process.stderr;\n    options = arg1 || arg2 || {};\n  }\n\n  this._status = {\n    spun: 0,\n    section: '',\n    subsection: ''\n  };\n  this._paused = false; // are we paused for back pressure?\n\n  this._disabled = true; // are all progress bar updates disabled?\n\n  this._showing = false; // do we WANT the progress bar on screen\n\n  this._onScreen = false; // IS the progress bar on screen\n\n  this._needsRedraw = false; // should we print something at next tick?\n\n  this._hideCursor = options.hideCursor == null ? true : options.hideCursor;\n  this._fixedFramerate = options.fixedFramerate == null ? !/^v0\\.8\\./.test(process.version) : options.fixedFramerate;\n  this._lastUpdateAt = null;\n  this._updateInterval = options.updateInterval == null ? 50 : options.updateInterval;\n  this._themes = options.themes || defaultThemes;\n  this._theme = options.theme;\n\n  var theme = this._computeTheme(options.theme);\n\n  var template = options.template || [{\n    type: 'progressbar',\n    length: 20\n  }, {\n    type: 'activityIndicator',\n    kerning: 1,\n    length: 1\n  }, {\n    type: 'section',\n    kerning: 1,\n    default: ''\n  }, {\n    type: 'subsection',\n    kerning: 1,\n    default: ''\n  }];\n  this.setWriteTo(writeTo, options.tty);\n  var PlumbingClass = options.Plumbing || Plumbing;\n  this._gauge = new PlumbingClass(theme, template, this.getWidth());\n  this._$$doRedraw = callWith(this, this._doRedraw);\n  this._$$handleSizeChange = callWith(this, this._handleSizeChange);\n  this._cleanupOnExit = options.cleanupOnExit == null || options.cleanupOnExit;\n  this._removeOnExit = null;\n\n  if (options.enabled || options.enabled == null && this._tty && this._tty.isTTY) {\n    this.enable();\n  } else {\n    this.disable();\n  }\n}\n\nGauge.prototype = {};\n\nGauge.prototype.isEnabled = function () {\n  return !this._disabled;\n};\n\nGauge.prototype.setTemplate = function (template) {\n  this._gauge.setTemplate(template);\n\n  if (this._showing) this._requestRedraw();\n};\n\nGauge.prototype._computeTheme = function (theme) {\n  if (!theme) theme = {};\n\n  if (typeof theme === 'string') {\n    theme = this._themes.getTheme(theme);\n  } else if (theme && (Object.keys(theme).length === 0 || theme.hasUnicode != null || theme.hasColor != null)) {\n    var useUnicode = theme.hasUnicode == null ? hasUnicode() : theme.hasUnicode;\n    var useColor = theme.hasColor == null ? hasColor : theme.hasColor;\n    theme = this._themes.getDefault({\n      hasUnicode: useUnicode,\n      hasColor: useColor,\n      platform: theme.platform\n    });\n  }\n\n  return theme;\n};\n\nGauge.prototype.setThemeset = function (themes) {\n  this._themes = themes;\n  this.setTheme(this._theme);\n};\n\nGauge.prototype.setTheme = function (theme) {\n  this._gauge.setTheme(this._computeTheme(theme));\n\n  if (this._showing) this._requestRedraw();\n  this._theme = theme;\n};\n\nGauge.prototype._requestRedraw = function () {\n  this._needsRedraw = true;\n  if (!this._fixedFramerate) this._doRedraw();\n};\n\nGauge.prototype.getWidth = function () {\n  return (this._tty && this._tty.columns || 80) - 1;\n};\n\nGauge.prototype.setWriteTo = function (writeTo, tty) {\n  var enabled = !this._disabled;\n  if (enabled) this.disable();\n  this._writeTo = writeTo;\n  this._tty = tty || writeTo === process.stderr && process.stdout.isTTY && process.stdout || writeTo.isTTY && writeTo || this._tty;\n  if (this._gauge) this._gauge.setWidth(this.getWidth());\n  if (enabled) this.enable();\n};\n\nGauge.prototype.enable = function () {\n  if (!this._disabled) return;\n  this._disabled = false;\n  if (this._tty) this._enableEvents();\n  if (this._showing) this.show();\n};\n\nGauge.prototype.disable = function () {\n  if (this._disabled) return;\n\n  if (this._showing) {\n    this._lastUpdateAt = null;\n    this._showing = false;\n\n    this._doRedraw();\n\n    this._showing = true;\n  }\n\n  this._disabled = true;\n  if (this._tty) this._disableEvents();\n};\n\nGauge.prototype._enableEvents = function () {\n  if (this._cleanupOnExit) {\n    this._removeOnExit = onExit(callWith(this, this.disable));\n  }\n\n  this._tty.on('resize', this._$$handleSizeChange);\n\n  if (this._fixedFramerate) {\n    this.redrawTracker = setInterval(this._$$doRedraw, this._updateInterval);\n    if (this.redrawTracker.unref) this.redrawTracker.unref();\n  }\n};\n\nGauge.prototype._disableEvents = function () {\n  this._tty.removeListener('resize', this._$$handleSizeChange);\n\n  if (this._fixedFramerate) clearInterval(this.redrawTracker);\n  if (this._removeOnExit) this._removeOnExit();\n};\n\nGauge.prototype.hide = function (cb) {\n  if (this._disabled) return cb && process.nextTick(cb);\n  if (!this._showing) return cb && process.nextTick(cb);\n  this._showing = false;\n\n  this._doRedraw();\n\n  cb && setImmediate(cb);\n};\n\nGauge.prototype.show = function (section, completed) {\n  this._showing = true;\n\n  if (typeof section === 'string') {\n    this._status.section = section;\n  } else if (typeof section === 'object') {\n    var sectionKeys = Object.keys(section);\n\n    for (var ii = 0; ii < sectionKeys.length; ++ii) {\n      var key = sectionKeys[ii];\n      this._status[key] = section[key];\n    }\n  }\n\n  if (completed != null) this._status.completed = completed;\n  if (this._disabled) return;\n\n  this._requestRedraw();\n};\n\nGauge.prototype.pulse = function (subsection) {\n  this._status.subsection = subsection || '';\n  this._status.spun++;\n  if (this._disabled) return;\n  if (!this._showing) return;\n\n  this._requestRedraw();\n};\n\nGauge.prototype._handleSizeChange = function () {\n  this._gauge.setWidth(this._tty.columns - 1);\n\n  this._requestRedraw();\n};\n\nGauge.prototype._doRedraw = function () {\n  if (this._disabled || this._paused) return;\n\n  if (!this._fixedFramerate) {\n    var now = Date.now();\n    if (this._lastUpdateAt && now - this._lastUpdateAt < this._updateInterval) return;\n    this._lastUpdateAt = now;\n  }\n\n  if (!this._showing && this._onScreen) {\n    this._onScreen = false;\n\n    var result = this._gauge.hide();\n\n    if (this._hideCursor) {\n      result += this._gauge.showCursor();\n    }\n\n    return this._writeTo.write(result);\n  }\n\n  if (!this._showing && !this._onScreen) return;\n\n  if (this._showing && !this._onScreen) {\n    this._onScreen = true;\n    this._needsRedraw = true;\n\n    if (this._hideCursor) {\n      this._writeTo.write(this._gauge.hideCursor());\n    }\n  }\n\n  if (!this._needsRedraw) return;\n\n  if (!this._writeTo.write(this._gauge.show(this._status))) {\n    this._paused = true;\n\n    this._writeTo.on('drain', callWith(this, function () {\n      this._paused = false;\n\n      this._doRedraw();\n    }));\n  }\n};","map":{"version":3,"sources":["D:/UIT/Nam3_HKI/OOP/SE100Project/client/node_modules/gauge/index.js"],"names":["Plumbing","require","hasUnicode","hasColor","onExit","defaultThemes","setInterval","process","setImmediate","module","exports","Gauge","callWith","obj","method","call","arg1","arg2","options","writeTo","write","stderr","_status","spun","section","subsection","_paused","_disabled","_showing","_onScreen","_needsRedraw","_hideCursor","hideCursor","_fixedFramerate","fixedFramerate","test","version","_lastUpdateAt","_updateInterval","updateInterval","_themes","themes","_theme","theme","_computeTheme","template","type","length","kerning","default","setWriteTo","tty","PlumbingClass","_gauge","getWidth","_$$doRedraw","_doRedraw","_$$handleSizeChange","_handleSizeChange","_cleanupOnExit","cleanupOnExit","_removeOnExit","enabled","_tty","isTTY","enable","disable","prototype","isEnabled","setTemplate","_requestRedraw","getTheme","Object","keys","useUnicode","useColor","getDefault","platform","setThemeset","setTheme","columns","_writeTo","stdout","setWidth","_enableEvents","show","_disableEvents","on","redrawTracker","unref","removeListener","clearInterval","hide","cb","nextTick","completed","sectionKeys","ii","key","pulse","now","Date","result","showCursor"],"mappings":"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","sourcesContent":["'use strict'\nvar Plumbing = require('./plumbing.js')\nvar hasUnicode = require('has-unicode')\nvar hasColor = require('./has-color.js')\nvar onExit = require('signal-exit')\nvar defaultThemes = require('./themes')\nvar setInterval = require('./set-interval.js')\nvar process = require('./process.js')\nvar setImmediate = require('./set-immediate')\n\nmodule.exports = Gauge\n\nfunction callWith (obj, method) {\n  return function () {\n    return method.call(obj)\n  }\n}\n\nfunction Gauge (arg1, arg2) {\n  var options, writeTo\n  if (arg1 && arg1.write) {\n    writeTo = arg1\n    options = arg2 || {}\n  } else if (arg2 && arg2.write) {\n    writeTo = arg2\n    options = arg1 || {}\n  } else {\n    writeTo = process.stderr\n    options = arg1 || arg2 || {}\n  }\n\n  this._status = {\n    spun: 0,\n    section: '',\n    subsection: ''\n  }\n  this._paused = false // are we paused for back pressure?\n  this._disabled = true // are all progress bar updates disabled?\n  this._showing = false // do we WANT the progress bar on screen\n  this._onScreen = false // IS the progress bar on screen\n  this._needsRedraw = false // should we print something at next tick?\n  this._hideCursor = options.hideCursor == null ? true : options.hideCursor\n  this._fixedFramerate = options.fixedFramerate == null\n    ? !(/^v0\\.8\\./.test(process.version))\n    : options.fixedFramerate\n  this._lastUpdateAt = null\n  this._updateInterval = options.updateInterval == null ? 50 : options.updateInterval\n\n  this._themes = options.themes || defaultThemes\n  this._theme = options.theme\n  var theme = this._computeTheme(options.theme)\n  var template = options.template || [\n    {type: 'progressbar', length: 20},\n    {type: 'activityIndicator', kerning: 1, length: 1},\n    {type: 'section', kerning: 1, default: ''},\n    {type: 'subsection', kerning: 1, default: ''}\n  ]\n  this.setWriteTo(writeTo, options.tty)\n  var PlumbingClass = options.Plumbing || Plumbing\n  this._gauge = new PlumbingClass(theme, template, this.getWidth())\n\n  this._$$doRedraw = callWith(this, this._doRedraw)\n  this._$$handleSizeChange = callWith(this, this._handleSizeChange)\n\n  this._cleanupOnExit = options.cleanupOnExit == null || options.cleanupOnExit\n  this._removeOnExit = null\n\n  if (options.enabled || (options.enabled == null && this._tty && this._tty.isTTY)) {\n    this.enable()\n  } else {\n    this.disable()\n  }\n}\nGauge.prototype = {}\n\nGauge.prototype.isEnabled = function () {\n  return !this._disabled\n}\n\nGauge.prototype.setTemplate = function (template) {\n  this._gauge.setTemplate(template)\n  if (this._showing) this._requestRedraw()\n}\n\nGauge.prototype._computeTheme = function (theme) {\n  if (!theme) theme = {}\n  if (typeof theme === 'string') {\n    theme = this._themes.getTheme(theme)\n  } else if (theme && (Object.keys(theme).length === 0 || theme.hasUnicode != null || theme.hasColor != null)) {\n    var useUnicode = theme.hasUnicode == null ? hasUnicode() : theme.hasUnicode\n    var useColor = theme.hasColor == null ? hasColor : theme.hasColor\n    theme = this._themes.getDefault({hasUnicode: useUnicode, hasColor: useColor, platform: theme.platform})\n  }\n  return theme\n}\n\nGauge.prototype.setThemeset = function (themes) {\n  this._themes = themes\n  this.setTheme(this._theme)\n}\n\nGauge.prototype.setTheme = function (theme) {\n  this._gauge.setTheme(this._computeTheme(theme))\n  if (this._showing) this._requestRedraw()\n  this._theme = theme\n}\n\nGauge.prototype._requestRedraw = function () {\n  this._needsRedraw = true\n  if (!this._fixedFramerate) this._doRedraw()\n}\n\nGauge.prototype.getWidth = function () {\n  return ((this._tty && this._tty.columns) || 80) - 1\n}\n\nGauge.prototype.setWriteTo = function (writeTo, tty) {\n  var enabled = !this._disabled\n  if (enabled) this.disable()\n  this._writeTo = writeTo\n  this._tty = tty ||\n    (writeTo === process.stderr && process.stdout.isTTY && process.stdout) ||\n    (writeTo.isTTY && writeTo) ||\n    this._tty\n  if (this._gauge) this._gauge.setWidth(this.getWidth())\n  if (enabled) this.enable()\n}\n\nGauge.prototype.enable = function () {\n  if (!this._disabled) return\n  this._disabled = false\n  if (this._tty) this._enableEvents()\n  if (this._showing) this.show()\n}\n\nGauge.prototype.disable = function () {\n  if (this._disabled) return\n  if (this._showing) {\n    this._lastUpdateAt = null\n    this._showing = false\n    this._doRedraw()\n    this._showing = true\n  }\n  this._disabled = true\n  if (this._tty) this._disableEvents()\n}\n\nGauge.prototype._enableEvents = function () {\n  if (this._cleanupOnExit) {\n    this._removeOnExit = onExit(callWith(this, this.disable))\n  }\n  this._tty.on('resize', this._$$handleSizeChange)\n  if (this._fixedFramerate) {\n    this.redrawTracker = setInterval(this._$$doRedraw, this._updateInterval)\n    if (this.redrawTracker.unref) this.redrawTracker.unref()\n  }\n}\n\nGauge.prototype._disableEvents = function () {\n  this._tty.removeListener('resize', this._$$handleSizeChange)\n  if (this._fixedFramerate) clearInterval(this.redrawTracker)\n  if (this._removeOnExit) this._removeOnExit()\n}\n\nGauge.prototype.hide = function (cb) {\n  if (this._disabled) return cb && process.nextTick(cb)\n  if (!this._showing) return cb && process.nextTick(cb)\n  this._showing = false\n  this._doRedraw()\n  cb && setImmediate(cb)\n}\n\nGauge.prototype.show = function (section, completed) {\n  this._showing = true\n  if (typeof section === 'string') {\n    this._status.section = section\n  } else if (typeof section === 'object') {\n    var sectionKeys = Object.keys(section)\n    for (var ii = 0; ii < sectionKeys.length; ++ii) {\n      var key = sectionKeys[ii]\n      this._status[key] = section[key]\n    }\n  }\n  if (completed != null) this._status.completed = completed\n  if (this._disabled) return\n  this._requestRedraw()\n}\n\nGauge.prototype.pulse = function (subsection) {\n  this._status.subsection = subsection || ''\n  this._status.spun ++\n  if (this._disabled) return\n  if (!this._showing) return\n  this._requestRedraw()\n}\n\nGauge.prototype._handleSizeChange = function () {\n  this._gauge.setWidth(this._tty.columns - 1)\n  this._requestRedraw()\n}\n\nGauge.prototype._doRedraw = function () {\n  if (this._disabled || this._paused) return\n  if (!this._fixedFramerate) {\n    var now = Date.now()\n    if (this._lastUpdateAt && now - this._lastUpdateAt < this._updateInterval) return\n    this._lastUpdateAt = now\n  }\n  if (!this._showing && this._onScreen) {\n    this._onScreen = false\n    var result = this._gauge.hide()\n    if (this._hideCursor) {\n      result += this._gauge.showCursor()\n    }\n    return this._writeTo.write(result)\n  }\n  if (!this._showing && !this._onScreen) return\n  if (this._showing && !this._onScreen) {\n    this._onScreen = true\n    this._needsRedraw = true\n    if (this._hideCursor) {\n      this._writeTo.write(this._gauge.hideCursor())\n    }\n  }\n  if (!this._needsRedraw) return\n  if (!this._writeTo.write(this._gauge.show(this._status))) {\n    this._paused = true\n    this._writeTo.on('drain', callWith(this, function () {\n      this._paused = false\n      this._doRedraw()\n    }))\n  }\n}\n"]},"metadata":{},"sourceType":"script"}